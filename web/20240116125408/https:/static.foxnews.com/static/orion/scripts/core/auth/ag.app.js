var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

/*! updated; 11-22-2024 02:36 PM **/


Modulr.define("core.auth:api",["require","jquery","config"],function(require,$,config){var INITIALIZED=!1;return new function(){this.AUTH_TYPE=""+config.authType,this.init=function(){INITIALIZED||(INITIALIZED=!0,require(["modules/navbar"]))},this.initLegacy=function(){INITIALIZED||(INITIALIZED=!0,require(["modules/navbar.legacy"]))},this.middleware=function(callback){"function"==typeof callback&&require(["models/middleware"],function(Middleware){callback(Middleware)})}}});
Modulr.define("core.auth:config",["require","jquery","cdn"],function(require,$){var res,search,require=require("cdn"),env=(require.domain,require.env),config={};return config.authType=("foxid",res="foxid",-1<(search=window.location.search).indexOf("_x_auth=foxid")?res="foxid":-1<search.indexOf("_x_auth=auth0")&&(res="auth0"),res),config.hostname="qa"===env?"aem-dev-publisher.foxnews.com":"foxnews.com",config.auth0={jslocation:"https://web.archive.org/web/20241122211050/https://cdn.auth0.com/js/auth0/8.9.2/auth0.min.js",profileApiUrl:function(){var res="qa"===env?"https://web.archive.org/web/20241122211050/https://foxnews-dev.us.webtask.io/userprofile":"https://web.archive.org/web/20241122211050/https://foxnews.us.webtask.io/userprofile";return res}()},config.profilePage=(search="auth0"===config.authType?"//web.archive.org/web/20241122211050/https://dev.static.":"//web.archive.org/web/20241122211050/https://dev-my.","auth0"===config.authType?"https:"+("qa"===env?search:"//web.archive.org/web/20241122211050/https://www.")+"foxnews.com/community/auth/user/profile.html":"https:"+("qa"===env?search:"//web.archive.org/web/20241122211050/https://my.")+"foxnews.com/?p=account"),config.cdn=require,config});
Modulr.define("core.auth:helper",["require","jquery","core.base:utils/cookie","core.base:utils/localStorage","core.plugins:AppWebviewEvents"],function(require,$,Cookie,LocalStorage){function Helper(){this.webviewEvents=require("core.plugins:AppWebviewEvents")({disableInit:!0})}return Helper.prototype.log=function(){if(window.console){var args=Array.prototype.slice.call(arguments);args.unshift("[core.auth]");try{return window.console.log.apply(window.console,args)}catch(err){window.console.log(args.join(" | "))}}},Helper.prototype.isAppMode=function(){var mode=new URLSearchParams(window.location.search).get("mode");return $("body").hasClass("app-mode")||"app"===mode||"true"===this.getWebviewFlag()||!!this.getWebviewAccessToken()},Helper.prototype.isHybridMode=function(){return"app"===new URLSearchParams(window.location.search).get("mode")},Helper.prototype.getWebviewAccessToken=function(){return Cookie.get("wv_at")||LocalStorage.get("wv_at")||null},Helper.prototype.getWebviewFlag=function(){return Cookie.get("wv")||LocalStorage.get("wv")||null},Helper.prototype.getStoragePrefix=function(){return"fxn_cstore__"},Helper.prototype.getWebviewTokenKey=function(){return"wv_at"},Helper.prototype.triggerProfileEvent=function(eventType){var isAppMode=this.isAppMode();this.webviewEvents&&isAppMode&&this.webviewEvents.triggerProfileEvent(eventType)},new Helper});
Modulr.define("core.auth:index",["require","jquery"],function(require,$){return require});
Modulr.define("core.auth:models/callback",["require","jquery","lodash","config","options"],function(require,$,_,config){return function(FNNAuth){console.log("callback file"),console.log(FNNAuth),document.querySelector("#resend_verification").addEventListener("click",function(e){e.preventDefault(),setTimeout(function(){window.swal.showLoading(),FNNAuth.callProfileApi("POST",{action:"verify_email"},function(err){window.swal.close(),err&&console.log(err)})},500)})}});
Modulr.define("core.auth:models/fnnauth.broker.auth0",["require","jquery","cdn","config"],function(require,$,CDN,config){function dispatch(event){if(event.origin===origin&&"fnnBrokerResponse"===event.data.type)if("ready"===event.data.name)for(ready=!0;0<queue.length;)iframe.contentWindow.postMessage(queue.shift(),origin);else{var cbs=callbacks[event.data.name]||[];for(callbacks[event.data.name]=[];0<cbs.length;)cbs.shift()(event.data.data)}}function startLogin(){addCallback("startLogin",function(url){window.location.href=url}),sendMessage("startLogin",window.location.href)}function startLogout(callback){callback&&addCallback("startLogout",callback),sendMessage("startLogout",null)}function FNNAuth(domainName){console.log("broker: auth0");var refreshProfile=-1!==window.location.search.indexOf("refresh_profile_info=on");(iframe=document.createElement("iframe")).style.display="none",iframe.src=iframeLink+(refreshProfile?"refresh_profile_info=on&":"")+"origin="+encodeURIComponent(root.location.origin)+"&domain="+encodeURIComponent(domainName),document.body.appendChild(iframe),root.addEventListener("message",dispatch)}var iframe,root=window,CDN=CDN.env,ready=!1,callbacks={},origin="https:"+("qa"===CDN?"//web.archive.org/web/20241122211050/https://dev.static.foxnews.com":"//web.archive.org/web/20241122211050/https://www.foxnews.com"),queue=[],iframeLink=origin+"/community/auth/user/iframe.html?_x_auth="+config.authType+"&",addCallback=function(name,cb){callbacks[name]=callbacks[name]||[],callbacks[name].push(cb)},sendMessage=function(name,data){name={name:name,data:data,type:"fnnBrokerRequest"};ready?iframe.contentWindow.postMessage(name,origin):queue.push(name)};return FNNAuth.prototype.initialize=function(callback){callback({startLogin:startLogin,startLogout:startLogout})},FNNAuth.prototype.MODE_silentLogin=function(callback){addCallback("silentLogin",callback),sendMessage("silentLogin",null)},FNNAuth});
Modulr.define("core.auth:models/fnnauth.broker",["require","jquery","cdn","config","fnc.isa","models/host","helper"],function(require,$,CDN,config,ISA,host,Helper){const isAppMode=Helper.isAppMode();function dispatch(event){if("fnnBrokerResponse"!==event.data.type)return!1;if(event.data.origin===window.location.protocol+"//"+window.location.host)if("ready"===event.data.name)for(ready=!0;0<queue.length;)iframe.contentWindow.postMessage(queue.shift(),iframeOrigin);else{-1<event.data.name.indexOf("-Broadcast")&&$(document).trigger("xd-channel-"+event.data.name.replace("-Broadcast",""),event.data.data);var cbs=callbacks[event.data.name]||[];for(callbacks[event.data.name]=[];0<cbs.length;)cbs.shift()(event.data.data)}}function startLogin(e){isAppMode?Helper.triggerProfileEvent():(addCallback("startLogin",function(url){var hasTarget=null;try{hasTarget=e.target.hasAttribute("data-omtr-intcmp")}catch(error){}hasTarget?ISA.provider("internal.campaign",function(Provider){window.location.href=Provider.setHash(url,e.target.getAttribute("data-omtr-intcmp"))}):window.location.href=url}),sendMessage("startLogin",window.location.href))}function startLogout(callback){callback&&addCallback("startLogout",callback),sendMessage("startLogout",null)}function clearPasswordlessUser(callback){callback&&"function"==typeof callback&&addCallback("clearPasswordlessUser",callback),sendMessage("clearPasswordlessUser",null)}function FNNAuth(domainName){var refreshProfile=-1!==window.location.search.indexOf("refresh_profile_info=on");(iframe=document.createElement("iframe")).id="xdchannel",iframe.style.display="none",iframe.src=iframeLink+(refreshProfile?"refresh_profile_info=on&":""),document.body.appendChild(iframe),root.addEventListener("message",dispatch)}var root=window,host=window.location.hostname.match(/(foxnews)/g)?host.fnc:host.fbn,ready=!1,callbacks={},iframeOrigin="https://"+host,queue=[],iframe=document.getElementById("xdchannel"),iframeLink=iframeOrigin+"/xd-channel.html?_x_auth="+config.authType+"&",addCallback=function(name,cb){callbacks[name]=callbacks[name]||[],callbacks[name].push(cb)},sendMessage=function(name,data,callback){data={name:name,data:data,type:"fnnBrokerRequest"};ready?(iframe.contentWindow.postMessage(data,iframeOrigin),callback&&"function"==typeof callback&&addCallback(name,callback)):queue.push(data)},grabAnonQueue=!(!window.FNC.anon||!window.FNC.anon.anon_fpid)&&{data:{anon_fpid:window.FNC.anon.anon_fpid()},name:"updateAnon"};return FNNAuth.prototype.initialize=function(callback){callback({startLogin:startLogin,startLogout:startLogout})},FNNAuth.prototype.sendMessage=sendMessage,FNNAuth.prototype.redirectURL=iframeOrigin,FNNAuth.prototype.addCallback=addCallback,FNNAuth.prototype.checkPendingRequest=function(callback){callback&&"function"==typeof callback&&addCallback("hasPendingPasswordless",callback),sendMessage("hasPendingPasswordless",null)},FNNAuth.prototype.startPasswordless=function(callback,options){if(options=options||{},callback&&"function"==typeof callback){const processCallbacks=response=>{response.data=response.data||{};var responseId=response.id||null,event=response.data.event||null,authed="authenticated"===event||!1;"poll:start"!==responseId&&"initialized"!==responseId&&"pending"!==event||addCallback("startPasswordless",processCallbacks),authed&&clearPasswordlessUser(),callback({authed:authed,response:response})};addCallback("startPasswordless",processCallbacks)}sendMessage("startPasswordless",options)},FNNAuth.prototype.clearPasswordlessUser=clearPasswordlessUser,FNNAuth.prototype.webviewLogin=function(callback,options){options=options||{},callback&&"function"==typeof callback&&addCallback("webviewLogin",callback),sendMessage("webviewLogin",options)},FNNAuth.prototype.MODE_silentLogin=function(callback){addCallback("silentLogin",callback),grabAnonQueue&&sendMessage(grabAnonQueue.name,grabAnonQueue.data),sendMessage("silentLogin",null)},FNNAuth.prototype.getUserInfo=function(attrs,callback){addCallback("getUserInfo",callback),sendMessage("getUserInfo",attrs)},FNNAuth});
Modulr.define("core.auth:models/fnnauth",["require","jquery","lodash","config","options","models/script.loader","cdn"],function(require,$,_,config){var domain,webAuth,options,root=window,DOMAIN_OPTIONS=require("options"),ScriptLoader=require("models/script.loader"),ssl=["htt","ps:"].join(""),http=["htt","p:"].join(""),storage=root.sessionStorage,document=root.document,auth0jslocation=config.auth0jslocation,profileApiUrl=config.profileApiUrl,errorEl=document.querySelector(".message-error"),errorElText=document.querySelector(".message-error > span"),successEl=document.querySelector(".message-success"),profileEditor=document.querySelector(".fn-user-profile"),profileOptionalFields=document.querySelector(".auth0-optional"),DEFAULT_PROFILE_PICTURE=ssl+"//web.archive.org/web/20241122211050/https://global.fncstatic.com/static/orion/styles/img/fox-news/auth0/auth0-default-profile-pic.png",FOX_LOGO_URL="//web.archive.org/web/20241122211050/https://global.fncstatic.com/static/orion/styles/img/fox-news/s/logos/fox-news-logo-small.svg",env=(-1!==navigator.userAgent.indexOf("Safari")&&navigator.userAgent.indexOf("Chrome"),require("cdn").env),connectionName="qa"===env?"user-data-migration":"Username-Password-Authentication-2",isIE=-1!==navigator.userAgent.indexOf("MSIE")||0<window.navigator.appVersion.indexOf("Trident/");function setupBirthdaySelects(){var evtIE,date,kcyear=document.getElementsByName("year")[0],kcmonth=document.getElementsByName("month")[0],kcday=document.getElementsByName("day")[0],kcbirthday=document.getElementsByName("birthday")[0],yearSelectInitialized=!1;function validate_date(){var y=+kcyear.value,m=kcmonth.value,d=kcday.value;""===m&&""===d&&(y=""),d<=9&&(d="0"+d),kcbirthday.value=[y=y<1920?"":y,m=m<=9?"0"+m:m,d="02"===m&&28<d||"04"===m&&30<d||"09"===m&&30<d||"11"===m&&30<d?"":d].join("-")}kcyear.onchange=kcmonth.onchange=kcday.onchange=function(){if(!yearSelectInitialized){for(var i=(new Date).getFullYear()-13;1920<=i;i--){var opt=new Option;opt.value=opt.text=i,kcyear.add(opt)}yearSelectInitialized=!0}validate_date()},kcyear.addEventListener("change",validate_date),kcday.addEventListener("change",validate_date),kcmonth.addEventListener("change",validate_date),kcbirthday.value&&(date=new Date(kcbirthday.value),date=new Date(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds()),isIE?((evtIE=document.createEvent("HTMLEvents")).initEvent("change",!1,!0),kcmonth.value=String(date.getMonth()+1),kcmonth.dispatchEvent(evtIE),kcday.value=String(date.getDate()),kcday.dispatchEvent(evtIE),kcyear.value=String(date.getFullYear()),kcyear.dispatchEvent(evtIE)):(kcmonth.value=String(date.getMonth()+1),kcmonth.dispatchEvent(new Event("change")),kcday.value=String(date.getDate()),kcday.dispatchEvent(new Event("change")),kcyear.value=String(date.getFullYear()),kcyear.dispatchEvent(new Event("change"))))}function scrollTo(elm){$("html, body").animate({scrollTop:$(elm).offset().top-60},300)}function showError(err,fn,options){var cancelAction;return hideSuccess(),errorEl&&!fn?(errorEl.style.display="block",errorElText.textContent=err.message||err,scrollTo(errorEl)):("function"==typeof(cancelAction=options.cancelAction)&&(options.showCancelButton=!0,delete options.cancelAction),options=window.swal(Object.assign({type:"error",title:"Uh Oh",text:err.message||err,customClass:"swal-error"},options)),fn&&options.then(fn),cancelAction?options.catch(function(dismiss){"string"==typeof dismiss&&cancelAction()}):options.catch(window.swal.noop)),err}function hideError(){errorEl&&(errorEl.style.display="none",errorElText.textContent=""),window.swal.close()}function showSuccess(msg,title,swalOpts){var cancelAction;if(hideError(),!successEl||swalOpts)return"function"==typeof(cancelAction=swalOpts.cancelAction)&&(swalOpts.showCancelButton=!0,delete swalOpts.cancelAction),title=window.swal(Object.assign({type:"success",title:title,text:msg,customClass:"swal-success",imageUrl:FOX_LOGO_URL},swalOpts)),cancelAction?title.catch(function(dismiss){"string"==typeof dismiss&&cancelAction()}):title.catch(window.swal.noop),title;successEl.style.display="block",successEl.querySelector("span").textContent=msg,scrollTo(successEl)}function hideSuccess(err){successEl&&(successEl.style.display="none",successEl.querySelector("span").textContent=""),window.swal.close()}function setAuthAttributeInBody(){document.body.setAttribute("data-auth",isAuthenticated().toString())}function callProfileApi(method,body,callback){if(void 0===callback&&(callback=body,body=void 0),!isAuthenticated())return callback(new Error("The user has to login to set the profile"));silentLogin(setResult(function(err,authResult){if(!isAuthenticated())return callback(new Error("The user has to login to set the profile"));var req=new XMLHttpRequest;req.open(method,profileApiUrl),req.setRequestHeader("Authorization","Bearer "+retrieveAccessToken()),req.setRequestHeader("Content-type","application/json"),req.onreadystatechange=function(){if(4===req.readyState){if(400<=req.status){var err=req.responseText;try{err=(err=JSON.parse(err)).message||err.error}catch(e){}return callback(new Error(err))}callback(null,req.responseText&&JSON.parse(req.responseText))}};try{req.send(body&&JSON.stringify(body))}catch(e){callback(e)}}))}function getDomainOptions(domain){return options=options||DOMAIN_OPTIONS[domain]}function loadJs(src,callback){ScriptLoader(src,callback)}function store(key,value){void 0!==value?storage.setItem(key,JSON.stringify(value)):storage.removeItem(key)}function retrieve(key){return JSON.parse(storage.getItem(key))}var storeAccessToken=store.bind(null,"fnnauth:accessToken"),storeProfile=store.bind(null,"fnnauth:profile"),storeTargetUrl=store.bind(null,"fnnauth:targetUrl"),retrieveAccessToken=retrieve.bind(null,"fnnauth:accessToken"),retrieveProfile=retrieve.bind(null,"fnnauth:profile"),retrieveTargetUrl=retrieve.bind(null,"fnnauth:targetUrl");function setResult(callback,updateProfile){return function(err,authResult){storeAccessToken(authResult&&authResult.accessToken),updateProfile&&storeProfile(authResult&&authResult.idTokenPayload),callback(err,authResult)}}function createLink(text,className,callback){var link=document.createElement("a");return link.className=className,link.innerHTML=text,link.addEventListener?link.addEventListener("click",callback):link.attachEvent("onclick",callback),link}function changePassword(e){e.preventDefault(),window.swal({title:"Reset Password",text:"Are you sure you would like to send a password reset email?",type:"question",showCloseButton:!0,customClass:"swal-success",imageUrl:FOX_LOGO_URL,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Send Reset Email"}).then(function(){window.swal.showLoading(),getWebAuth(function(webAuth){getUserProfile(function(err,profile){if(err)return err.message=err.message||err.description,showError(err.message);webAuth.changePassword({connection:connectionName,email:profile.email},function(err,resp){return err?(err.message=err.description,showError(err)):showSuccess("An email has been sent to your inbox.")})})})}).catch(window.swal.noop)}function deleteAccount(e){e.preventDefault(),window.swal({title:"Delete Account",text:"Are you sure you want to permanently delete your Fox News Digital account? You will lose your activity history and email preferences.",type:"question",showCloseButton:!0,customClass:"swal-error",imageUrl:FOX_LOGO_URL,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Delete Account"}).then(function(){setTimeout(function(){window.swal.showLoading(),getUserProfile(function(err,profile){if(err)return err.message=err.message||err.description,showError(err);callProfileApi("DELETE",function(err){err?(err.message=err.description,window.swal({type:"error",title:"uh oh",text:err.message})):(showSuccess("Account deleted."),startLogout())})})},1e3)}).catch(window.swal.noop)}function checkIfEmailVerified(profile){profile=profile||{};var profileContent=$(".auth0-profile-content"),authVerify=document.getElementById("auth0-verify");profile.email_verified?profileContent.removeClass("hide"):(authVerify&&authVerify.classList.remove("hide"),profileContent.addClass("hide"),1<profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/logins_count"]&&resendVerificationEmail(),setTimeout(function(){startCallbackLogout()},1e3))}function checkIfAccountActive(profile){profile&&"false"===profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/metadata"].account_active?profileOptionalFields&&(profileEditor.classList.add("hide"),profileOptionalFields.classList.remove("hide")):profile&&"false"!==profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/metadata"].account_active&&profileOptionalFields&&(profileEditor.classList.remove("hide"),profileOptionalFields.classList.add("hide"))}function setupProfileEditor(profile){var comment_notification,reply_notification,metadata=_metadata=profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/metadata"]||{},newsletters=(checkIfEmailVerified(profile),checkIfAccountActive(profile),metadata.picture===DEFAULT_PROFILE_PICTURE&&editPhotoBtn&&(editPhotoBtn.style.display="none"),Object.keys(metadata).forEach(function(key){["true","false"].includes(metadata[key])&&(metadata[key]="true"===metadata[key])}),metadata.newsletters||{}),like_notification=metadata.commenting_notifications?(comment_notification=metadata.commenting_notifications.comment_notification,reply_notification=metadata.commenting_notifications.reply_notification,metadata.commenting_notifications.like_notification):reply_notification=comment_notification="daily";profileEditor.querySelector("[name='email']").value=profile.email,profileEditor.querySelector("[name='birthday']").value=metadata.birthday,profileEditor.querySelector("[name='first_name']").value=metadata.first_name,profileEditor.querySelector("[name='last_name']").value=metadata.last_name,profileEditor.querySelector("[name='display_name']").value=metadata.display_name,profileEditor.querySelector("[name='zip_code']").value=metadata.zip_code||"",profileEditor.querySelector("[name='political_views']").value=metadata.political_views,profileEditor.querySelector("[name='household_income']").value=metadata.household_income,profileEditor.querySelector("[name='gender']").value=metadata.gender,profileEditor.querySelector("[name='fb_breaking_alerts']").checked=newsletters.fb_breaking_alerts,profileEditor.querySelector("[name='fn_breaking_alerts']").checked=newsletters.fn_breaking_alerts,profileEditor.querySelector("[name='fn_morn_headlines']").checked=newsletters.fn_morn_headlines,profileEditor.querySelector("[name='top_headline']").checked=newsletters.top_headline,profileEditor.querySelector("[name='fn_opinion_headlines']").checked=newsletters.fn_opinion_headlines,profileEditor.querySelector("[name='fn_fox_411_newsletter']").checked=newsletters.fn_fox_411_newsletter,profileEditor.querySelector("[name='fn_science_and_technology']").checked=newsletters.fn_science_and_technology,profileEditor.querySelector("[name='fn_health_newsletter']").checked=newsletters.fn_health_newsletter,profileEditor.querySelector("[name='fox_fan_scoop']").checked=newsletters.fox_fan_scoop,profileEditor.querySelector("[name='halftime_report']").checked=newsletters.halftime_report,profileEditor.querySelector("[name='comments'][value='"+comment_notification+"']").checked=!0,profileEditor.querySelector("[name='replies'][value='"+reply_notification+"']").checked=!0,profileEditor.querySelector("[name='likes'][value='"+like_notification+"']").checked=!0,profileEditor.querySelector("[name='comments-mobile']").value=comment_notification,profileEditor.querySelector("[name='replies-mobile']").value=reply_notification,profileEditor.querySelector("[name='likes-mobile']").value=like_notification,profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/is_social"]||document.querySelector(".auth0-group-password").classList.remove("hide"),profileOptionalFields.querySelector("[name='political_views']").value=metadata.political_views,profileOptionalFields.querySelector("[name='household_income']").value=metadata.household_income,profileOptionalFields.querySelector("[name='halftime_report']").checked=newsletters.halftime_report,profileOptionalFields.querySelector("[name='fn_breaking_alerts']").checked=newsletters.fn_breaking_alerts,profileOptionalFields.querySelector("[name='fn_morn_headlines']").checked=newsletters.fn_morn_headlines,profileOptionalFields.querySelector("[name='top_headline']").checked=newsletters.top_headline,setupBirthdaySelects(),document.querySelector("#save-profile").addEventListener("click",function(e){e.preventDefault(),saveProfileMetadata()}),document.querySelector("#submit_optional_fields").addEventListener("click",function(e){var cb;e.preventDefault(),(e=_metadata).political_views=profileOptionalFields.querySelector("[name='political_views']").value,e.household_income=profileOptionalFields.querySelector("[name='household_income']").value,e.account_active="true",e.newsletters={fn_breaking_alerts:profileOptionalFields.querySelector("[name='fn_breaking_alerts']").checked,fn_morn_headlines:profileOptionalFields.querySelector("[name='fn_morn_headlines']").checked,top_headline:profileOptionalFields.querySelector("[name='top_headline']").checked,halftime_report:profileOptionalFields.querySelector("[name='halftime_report']").checked},window.swal.showLoading(),setUserMetadata(e,function(err){if(cb&&setTimeout(function(){cb(err)},100),err)return showError(err);location.href="qa"===env?http+"//web.archive.org/web/20241122211050/https://hp.dev-cms.foxnews.com/":http+"//web.archive.org/web/20241122211050/https://foxnews.com/"}),profileEditor.classList.remove("hide"),profileOptionalFields.classList.add("hide")}),document.querySelector("#skip_optional_fields").addEventListener("click",function(e){var cb;e.preventDefault(),(e=_metadata).account_active="true",window.swal.showLoading(),setUserMetadata(e,function(err){if(cb&&setTimeout(function(){cb(err)},100),err)return showError(err);location.href="qa"===env?http+"//web.archive.org/web/20241122211050/https://hp.dev-cms.foxnews.com":http+"//web.archive.org/web/20241122211050/https://foxnews.com/"}),profileEditor.classList.remove("hide"),profileOptionalFields.classList.add("hide")})}function createWebAuth(){return webAuth=webAuth||new window.auth0.WebAuth(options.default)}function getUserProfile(callback,useSilentLogin){if(!isAuthenticated())return callback(new Error("The user has to login to get the profile"));useSilentLogin=!1!==useSilentLogin;var profile=retrieveProfile(),clearProfileCache=-1!==location.search.indexOf("refresh_profile_info=on");if(profile&&!clearProfileCache)return callback(null,profile);var token=retrieveAccessToken();getWebAuth(function(webAuth){webAuth.client.userInfo(token,function(err,user){if(err){if(!useSilentLogin)return callback(err);silentLogin(getUserProfile.bind(null,callback,!1))}storeProfile(user),callback(null,user)})})}function setUserMetadata(profile,callback){var auth0Authenticate=$("#auth0-authenticate");if(!isAuthenticated())return auth0Authenticate&&auth0Authenticate.removeClass("hide"),callback(new Error("The user has to login to set the profile"));setUserProfile({user_metadata:profile},callback)}function initialize_AUTHZERO(profileElSel,loginElSel){document.getElementById(profileElSel);var profileElSel=document.getElementById(loginElSel),loginElSel=document.querySelector("a.login"),logoutBtn=document.querySelector(".auth0-btn-logout"),changePassEl=document.getElementById("change-pass");loginElSel?loginElSel.onclick=startLogin:profileElSel.appendChild(createLink("Login","fnnauth0-login",startLogin)),logoutBtn?logoutBtn.onclick=startLogout:changePassEl&&changePassEl.parentElement.insertBefore(createLink("Log Out","fnnauth0-logout",startLogout),document.getElementById("change-pass")),(editPhotoBtn=document.querySelector(".auth0-edit-photo > a"))&&(editPhotoBtn.onclick=function(e){window.swal({title:"Remove Photo",text:"Are you sure you want to remove this photo? You will not be able to upload a new image.",type:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Remove photo",cancelButtonText:"No, cancel!",imageUrl:FOX_LOGO_URL,customClass:"swal-error"}).then(function(){_metadata.picture=DEFAULT_PROFILE_PICTURE,saveProfileMetadata(function(err){err||location.reload()})}).catch(window.swal.noop),e.preventDefault()}),setAuthAttributeInBody(),isAuthenticated()?renderUserInfo():silentLogin(authnCallback)}function FNNAuth(domainName,useRedirect){domain=domainName||root.location.hostname,options=getDomainOptions(domain)}var LOAD_INITIALIZED,LOAD_STACK,editPhotoBtn,_metadata={},saveProfileMetadata=function(cb){var metadata=_metadata,screensize=document.documentElement.clientWidth;metadata.first_name=profileEditor.querySelector("[name='first_name']").value,metadata.birthday=profileEditor.querySelector("[name='birthday']").value||"",metadata.last_name=profileEditor.querySelector("[name='last_name']").value,metadata.display_name=profileEditor.querySelector("[name='display_name']").value,metadata.political_views=profileEditor.querySelector("[name='political_views']").value,metadata.household_income=profileEditor.querySelector("[name='household_income']").value,metadata.gender=profileEditor.querySelector("[name='gender']").value,metadata.zip_code=profileEditor.querySelector("[name='zip_code']").value||"",metadata.account_active="true",metadata.picture!==DEFAULT_PROFILE_PICTURE&&(metadata.picture=profileEditor.querySelector("[name='profile_picture']").getAttribute("src")||""),metadata.newsletters={fb_breaking_alerts:profileEditor.querySelector("[name='fb_breaking_alerts']").checked,fn_breaking_alerts:profileEditor.querySelector("[name='fn_breaking_alerts']").checked,fn_morn_headlines:profileEditor.querySelector("[name='fn_morn_headlines']").checked,top_headline:profileEditor.querySelector("[name='top_headline']").checked,fn_opinion_headlines:profileEditor.querySelector("[name='fn_opinion_headlines']").checked,fn_fox_411_newsletter:profileEditor.querySelector("[name='fn_fox_411_newsletter']").checked,fn_science_and_technology:profileEditor.querySelector("[name='fn_science_and_technology']").checked,fn_health_newsletter:profileEditor.querySelector("[name='fn_health_newsletter']").checked,fox_fan_scoop:profileEditor.querySelector("[name='fox_fan_scoop']").checked,halftime_report:profileEditor.querySelector("[name='halftime_report']").checked},metadata.commenting_notifications=screensize<768?{comment_notification:profileEditor.querySelector("[name='comments-mobile']").value,reply_notification:profileEditor.querySelector("[name='replies-mobile']").value,like_notification:profileEditor.querySelector("[name='likes-mobile']").value}:{comment_notification:profileEditor.querySelector("[name='comments']:checked").value,reply_notification:profileEditor.querySelector("[name='replies']:checked").value,like_notification:profileEditor.querySelector("[name='likes']:checked").value},window.swal.showLoading(),setUserMetadata(metadata,function(err){if(cb&&setTimeout(function(){cb(err)},100),err)return showError(err);showSuccess("You have successfully updated your settings.")})},resendVerificationEmail=function(){setTimeout(function(){window.swal.showLoading(),callProfileApi("POST",{action:"verify_email"},function(err){window.swal.close(),err&&window.console.log(err)})},500)},renderUserInfo=function(){getUserProfile(function(err,profile){var deleteAccountModal;err?console.error("Error retrieving the user profile",err):(err=document.getElementById("change-pass"),deleteAccountModal=document.getElementById("delete-account"),err&&err.addEventListener("click",changePassword),deleteAccountModal&&(isIE?$("#delete-account").addClass("hide"):deleteAccountModal.addEventListener("click",deleteAccount)),function(profile){for(var elements=document.querySelectorAll("[data-user-field]"),i=elements.length-1;0<=i;i--){var el=elements[i],field=el.getAttribute("data-user-field"),field=profile[field]||profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/"+field];"IMG"===el.tagName?el.setAttribute("src",field):el.textContent=field}}(profile),setupProfileEditor(profile))})},loadAuth0js=(LOAD_INITIALIZED=!1,LOAD_STACK=[],function(callback){root.auth0?callback(createWebAuth()):(LOAD_STACK.push(callback),LOAD_INITIALIZED||(LOAD_INITIALIZED=!0,loadJs(auth0jslocation,function(){if(0<LOAD_STACK.length)for(;0<LOAD_STACK.length;)LOAD_STACK.shift()(createWebAuth())})))}),getWebAuth=function(callback){loadAuth0js(function(){webAuth=webAuth||new root.auth0.WebAuth(options.default),callback(webAuth)})},silentLogin=function(callback){getWebAuth(function(webAuth){webAuth.renewAuth(options.silent,setResult(callback))})},auth0Logout=window.auth0logout=function(cb){getWebAuth(function(webAuth){var iframe=document.createElement("iframe");iframe.style.display="none",iframe.src=webAuth.client.buildLogoutUrl(),iframe.onload=iframe.onerror=cb,document.body.appendChild(iframe)})},startLogout=function(e){"object"==typeof e&&e.preventDefault(),storeAccessToken(),storeProfile(),window.swal.showLoading(),auth0Logout(function(){var lastPageVisited;"function"==typeof e?e():!(-1<(lastPageVisited=document.referrer).indexOf("callback"))&&-1<lastPageVisited.indexOf("fox")?location.href=lastPageVisited:location.href=http+"//web.archive.org/web/20241122211050/https://foxnews.com"})},startLogin=function(e){e&&e.preventDefault(),storeTargetUrl(window.location.href),getWebAuth(function(webAuth){webAuth.authorize(options.authorize)})},startCallbackLogout=function(e){"object"==typeof e&&e.preventDefault(),storeAccessToken(),storeProfile(),auth0Logout(function(){"function"==typeof e&&e()})},authnCallback=function(err,authResult){!err&&authResult&&authResult.accessToken?(console.log("Login completed successfully"),renderUserInfo()):console.log("Unsuccessful attempt to login",err,authResult),setAuthAttributeInBody()},setUserProfile=window.setUserProfile=function(profile,callback){callProfileApi("PATCH",profile,function(err,data){if(err)return callback(err);silentLogin(setResult(function(){getUserProfile(callback)},!0))})},isAuthenticated=function(){return!!retrieveAccessToken()};FNNAuth.prototype.initialize=function(){var events,args=arguments;"function"==typeof args[0]?(events={startLogin:startLogin,startLogout:startLogout},args[0](events)):initialize_AUTHZERO.call(initialize_AUTHZERO,arguments)},FNNAuth.prototype.login=function(callback){isAuthenticated()?getUserProfile(callback):silentLogin(function(err,authResult){if(err)return callback(err);isAuthenticated()?getUserProfile(callback,!1):startLogin()})},FNNAuth.prototype.startIframeLogin=function(url,callback){var optionsLogin=webAuth.transactionManager.process(_.merge({},options.default,options.authorize));store("auth0.state."+(optionsLogin=_.omit(optionsLogin,["domain","root_url","overrides","tenant","token_issuer"])).state,optionsLogin.nonce),storeTargetUrl(url),getWebAuth(function(webAuth){callback(webAuth.client.buildAuthorizeUrl(optionsLogin))})},FNNAuth.prototype.isAuthenticated=isAuthenticated,FNNAuth.prototype.getUserProfile=getUserProfile,FNNAuth.prototype.setUserMetadata=setUserMetadata,FNNAuth.prototype.startIframeLogout=function(cb){return storeAccessToken(),storeProfile(),auth0Logout(function(){cb()}),!1},FNNAuth.prototype.showError=showError,FNNAuth.prototype.hideError=hideError,FNNAuth.prototype.showSuccess=showSuccess,FNNAuth.prototype.hideSuccess=hideSuccess,FNNAuth.prototype.callProfileApi=callProfileApi,FNNAuth.prototype.startLogout=startLogout,FNNAuth.prototype.MODE_silentLogin=function(callback){if(isAuthenticated())return callback({authenticated:!0,token:retrieveAccessToken()});function done(isAuth,userInfo){callback({authenticated:isAuth,token:retrieveAccessToken(),userInfo:userInfo})}silentLogin(function(err,authResult){err||authResult||console.warn("Authentication cancelled");var isAuth=isAuthenticated();isAuth?getUserProfile(function(userInfo){done(isAuth,userInfo)}):done(isAuth,null)})};return FNNAuth.initialize=function(profileElement,loginElement,domain,redirect){new FNNAuth(domain,redirect).initialize(profileElement,loginElement)},FNNAuth.handleCallback=function(domain){options=getDomainOptions(domain||root.location.hostname),getWebAuth(function(webAuth){var optionsParse={},index=(window.location.hash||"").indexOf("state=");0<=index&&(index=window.location.hash.substr(index+6).split("&").shift(),optionsParse.nonce=retrieve("auth0.state."+index),store("auth0.state."+index)),webAuth.parseHash(optionsParse,setResult(function(err,authResult){function redirectUser(profile){var redirect=retrieveTargetUrl()||root.location.origin;storeTargetUrl(),root.opener,profile&&!profile.email_verified?startCallbackLogout():(checkIfAccountActive(profile),function(profile){profile&&"false"===profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/metadata"].account_active&&root.location.href!==config.profilePage?root.location.href=config.profilePage:-1!==redirect.indexOf("community/auth/user/login.html")&&"false"!==profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/metadata"].account_active||-1!==redirect.indexOf("community/auth/user/login-password.html")&&"false"!==profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/metadata"].account_active||-1!==redirect.indexOf("community/auth/user/login-unblocked.html")&&"false"!==profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/metadata"].account_active||-1!==redirect.indexOf("community/auth/user/login-general.html")&&"false"!==profile[ssl+"//web.archive.org/web/20241122211050/https://foxnews.com/metadata"].account_active?root.location.href=http+"//web.archive.org/web/20241122211050/https://www.foxnews.com/":root.location.href=redirect===ssl+"//web.archive.org/web/20241122211050/https://dev.static.foxnews.com"?config.profilePage:redirect}(profile))}if(err)return console.log(err),redirectUser();getUserProfile(function(err,profile){if(checkIfEmailVerified(profile=profile||{}),profile.email_verified)return profile.email_verified&&checkIfAccountActive(profile),redirectUser(profile)})}))})},FNNAuth});
Modulr.define("core.auth:models/host",["core.base:utils/search.query"],function(QSP){var isProd=-1<window.location.search.indexOf("_useprodlogin"),isProd={isProd:isProd,fbn:"my.foxbusiness.com",fnc:"my.foxnews.com"};return window.location.search.indexOf("_log=1")&&window.console.log("spot - host values:",isProd),isProd});
Modulr.define("core.auth:models/middleware",["require","jquery","lodash","config","helper","models/host","models/fnnauth.broker","models/fnnauth.broker.auth0","core.base:utils/localStorage","core.base:utils/cookie","core.plugins:EventMessageHandler","fnc.isa","models/webview"],function(require,$,_,config,Helper,host){var Authentication=require("auth0"===config.authType?"models/fnnauth.broker.auth0":"models/fnnauth.broker"),ISA=require("fnc.isa"),Auth=new Authentication(config.hostname),Authentication=require("core.plugins:EventMessageHandler"),Cookies=(require("core.base:utils/localStorage"),require("core.base:utils/cookie"));const isAppMode=Helper.isAppMode(),isHybridMode=Helper.isHybridMode(),WebviewAuthController=require("models/webview"),Events=new Authentication;return new function(){var Proto=this,_props=null,_events=null,spotim_notifier=null,WebviewController=null;Proto.broker=Auth,Proto.getProps=function(){return _props},Proto.getEvents=function(){return _events},Proto.onLogin=function(cb){if(!cb&&"function"!=typeof cb)return!1;spotim_notifier=cb},Proto.set=function(callback){"function"==typeof callback&&(Events.addHandler("myfoxAutoLogin",data=>{ISA&&ISA.track;data&&data.ename&&ISA.track(data.ename,data)}),Auth.initialize(function(events){Proto.isAuthenticated(function(props){if(Helper.log("is authenticated?",props.authenticated),_events=events,(_props=props).authenticated||(document.addEventListener("spot-im-login-start",function(e){Proto.gotoPage("profile")}),window.SPOTIM&&window.SPOTIM.logout?window.SPOTIM.logout():document.addEventListener("spot-im-api-ready",function(){window.SPOTIM.logout()})),"function"==typeof spotim_notifier&&spotim_notifier(props,events),window.location.hostname.includes("foxnews")){const loginStatus=props.authenticated;ISA.provider("braze",function(Provider){var userInfo;Provider&&(Provider.Braze.getUser().setCustomUserAttribute("fn_u_log_stat_web",loginStatus),loginStatus&&(userInfo=props.userInfo)&&(userInfo=userInfo["https://web.archive.org/web/20241122211050/https://foxnews.com/user_id"],Provider.Braze.changeUser(userInfo)))})}Proto.updateAnon(props.anon),Proto.insertAnonSegments(props.anon),function(props){props=props.authenticated;Cookies("UID_STATE",props,{expires:365,path:"/",domain:".foxnews.com"})}(props),callback({authenticated:props.authenticated,userInfo:props.userInfo,token:props.token,anon:props.anon,events:events})})}))},Proto.isAuthenticated=function(callback){isAppMode?(WebviewController=WebviewAuthController(Auth,callback),isHybridMode||WebviewController.initWebview()):Auth.checkPendingRequest(function(hasPending){hasPending.hasPendingPasswordless?Auth.startPasswordless(response=>{response.authed?((response=new URL(location.href)).searchParams.set("login","success"),location.assign(response.search)):Auth.MODE_silentLogin(function(props){callback(props)})}):Auth.MODE_silentLogin(function(props){callback(props)})})},Proto.updateAnon=function(loginState){loginState&&loginState.segment&&window.FNC.anon&&window.FNC.anon.updateAnon(!!loginState.segment.dcg_profile_id)},Proto.insertAnonSegments=function(propData){var fn;window.FNC.anon=window.FNC.anon||{},propData&&propData.segment&&(propData.segment.lastAnonymousProfileId="function"==typeof(fn=_.get(window.FNC,"anon.persist_fpid",null))?fn():null),ISA.anon.pushAnon(propData),window.leapmetrics.push(function(Leap){function cookieVals(key){Leap.cookieProps("get",key)}var traits={dcg_profile_id:(cookieVals("userProfileId"),""),lastAnonymousProfileId:(cookieVals("lastAnonymousProfileId"),cookieVals("persistAnonId"),window.localStorage.getItem("anon_fpid")||window.localStorage.getItem("persist_fpid")||propData&&propData.value||""),lastKnownProfileId:(cookieVals("lastKnownId"),cookieVals("userProfileId"),"")};Leap.callPage(traits)})},Proto.gotoPage=function(page){var url;isAppMode?Helper.triggerProfileEvent():(url=null,"profile"===page&&(-1<window.location.hostname.indexOf("foxnews")?url=host.fnc:-1<window.location.hostname.indexOf("foxbusiness")&&(url=host.fbn)),url&&window.open("https://"+url,"_self"))},Proto.logout=function(){alert("todo: logout")}}});
Modulr.define("core.auth:models/script.loader",["require","jquery"],function(require,$){return function(src,callback){var BUILD_VERSION="function"==typeof Modulr.getGlobalCacheParam?Modulr.getGlobalCacheParam():null,isOpera=void 0!==window.opera&&"[object Opera]"===window.opera.toString()||-1<navigator.userAgent.indexOf("Opera")?1:0,script=document.createElement("script");script.async=!0,!script.attachEvent||script.attachEvent.toString&&script.attachEvent.toString().indexOf("[native code")<0||isOpera?(script.addEventListener("load",callback,!1),script.addEventListener("error",function(){throw new Error("Error loading script: "+src)},!1)):script.attachEvent("onreadystatechange",callback),BUILD_VERSION&&(src=src+(-1<src.indexOf("?")?"&":"?")+"v="+BUILD_VERSION),script.src=src,document.getElementsByTagName("head")[0].appendChild(script)}});
Modulr.define("core.auth:models/webview",["require","helper","core.plugins:AppWebviewEvents"],function(Require,Helper){const STORAGE_PREFIX=Helper.getStoragePrefix(),WV_TOKEN_KEY=Helper.getWebviewTokenKey();class WebviewAuth{constructor(Broker,callback){this.Broker=Broker,this.callback=callback,this.accessToken=null,this.webviewInit=!1,this.AppWebviewEvents=null,this.init(),this.registerStorageListener(this.init.bind(this))}init(){this.accessToken=Helper.getWebviewAccessToken(),this.webviewLogin()}webviewLogin(){const auth=this.Broker;var accessToken=Helper.getWebviewAccessToken();auth.webviewLogin(authResponse=>{auth.MODE_silentLogin(authResponse=>{this.callback&&"function"==typeof this.callback&&this.callback(authResponse)})},{accessToken:accessToken})}registerStorageListener(callback){window&&window.addEventListener&&window.addEventListener("storage",event=>{""+STORAGE_PREFIX+WV_TOKEN_KEY===event.key&&callback&&"function"==typeof callback&&callback()})}initWebview(){var AppWebviewEvents;this.webviewInit||(AppWebviewEvents=Require("core.plugins:AppWebviewEvents")(),this.AppWebviewEvents=AppWebviewEvents,this.webviewInit=!0,AppWebviewEvents.allowedLinks([]),AppWebviewEvents.ready())}}return(Broker,callback)=>new WebviewAuth(Broker,callback)});
Modulr.define("core.auth:modules/login-success",["require","jquery","lodash","core.templates:controls/api"],function(require,$,_){const Template=require("core.templates:controls/api");return new class{constructor(){var queryParams=new URLSearchParams(window.location.search);if(this.fbn=Boolean(window.location.hostname.match(/(foxbusiness)/g)),this.body=document.body,this.successModal=null,this.display="success"===queryParams.get("login"),this.display){queryParams.delete("login");let adjustedParams=queryParams.toString();0<adjustedParams.length&&(adjustedParams="?"+adjustedParams),window.history.replaceState({},"",""+location.pathname+adjustedParams+location.hash)}this.userInfo=null}run(userInfo){this.display&&(this.userInfo=userInfo,this.renderModal())}renderModal(){Template.get("/static/orion/scripts/core/auth/app/templates/loginSuccess.html",html=>{var site=this.fbn?"FOX Business":"FOX News",html=_.template(html)({site:site}),site=document.createElement("div");site.classList.add("login-success-modal"),site.innerHTML=html,this.body.appendChild(site),this.successModal=site,this.registerCloseEvent()})}registerCloseEvent(){document.querySelector(".login-success-modal .close-modal").addEventListener("click",e=>{e.preventDefault(),this.closeModal()})}closeModal(){this.successModal&&this.successModal.remove()}}});
Modulr.define("core.auth:modules/navbar",["require","jquery","config","cdn","fnc.isa","core.auth:modules/login-success"],function(require,$,config){let LoginSuccess=require("core.auth:modules/login-success");var target=$("#account"),ISA=(require("cdn"),require("fnc.isa")),protocol=["htt","ps:"].join("");ISA.provider("eu").check(function(bool){bool?target.hide():window.FNC.core.noticias?$(".user-profile.user-login.button").removeClass("show"):require(["models/middleware"],function(Middleware){Middleware.set(function(props){var markup;props.authenticated?(0!==target.length&&(markup=(markup='<div class="user-profile">                        <a href="#" class="avatar" aria-label="User Profile">                            <div class="m">                                <img src="${avatar}" data-user-field="picture" alt="User Avatar">                            </div>                        </a>                    </div>').replace("${avatar}",props.userInfo[protocol+"//web.archive.org/web/20241122211050/https://foxnews.com/picture"]),target.addClass("logged-in").removeClass("logged-out").html(markup),target.find(".user-profile a.avatar").on("click",function(evt){evt.preventDefault(),Middleware.gotoPage("profile")})),LoginSuccess.run(props.userInfo)):0!==target.length&&(target.addClass("logged-out").removeClass("logged-in"),target.find(".user-profile.user-login.button > a.login").on("click",props.events.startLogin),-1<location.search.indexOf("launch_login_page=on")&&props.events.startLogin()),$(".user-profile.user-login.button").addClass("show")})})})});
Modulr.define("core.auth:modules/navbar.legacy",["require","jquery","config","cdn","fnc.isa"],function(require,$,config){var protocol,target=$("#account");0!==target.length&&(target.addClass("network-access"),require("cdn"),$=require("fnc.isa"),protocol=["htt","ps:"].join(""),$.provider("eu").check(function(bool){bool?target.hide():require(["models/middleware"],function(Middleware){Middleware.set(function(props){var markup;props.authenticated?(markup=(markup='<div class="desktop user-profile">                        <a href="#" class="avatar" aria-label="User Profile"><img src="${avatar}" data-user-field="picture" alt="User Avatar"></a>                        <div id="profile-hover">                            <div>                                <span></span>                                <ul>                                    <li><a target=_blank class="profile" href="#">Profile</a></li>                                    <li><a class="logout" href="#">Log Out</a></li>                                </ul>                            </div>                        </div>                    </div>                    <div class="mobile-tablet">                        <div class="welcome">Welcome, <span>${username}</span></div>                            <div class="access">                            <a class="profile" href="#">Profile</a> |                            <a class="logout" href="#">Logout</a>                        </div>                    </div>').replace("${avatar}",props.userInfo[protocol+"//web.archive.org/web/20241122211050/https://foxnews.com/picture"]),target.html(markup),target.addClass("logged-in"),target.find("a.profile").on("click",function(evt){return evt.preventDefault(),Middleware.gotoPage("profile"),!1}),target.find(".user-profile a.avatar").on("click",function(evt){return evt.preventDefault(),alert("Fox News is unable to edit your profile at this time. We'll be back up and running again soon. Thanks for your patience!"),!1}),target.find("a.logout").on("click",props.events.startLogout)):(target.html('<div class="access mobile-tablet"><a class="login" href="#">Login</a></div><a class="login desktop" href="#">Login</a>'),target.find("a.login").on("click",props.events.startLogin),-1<location.search.indexOf("launch_login_page=on")&&props.events.startLogin())})})}))});
Modulr.define("core.auth:options",["require","jquery","cdn"],function(require,$){var require=require("cdn"),require=(require.domain,require.env,["htt","ps:"].join("")),options={};return options.localhost={default:{domain:"testing-foxnews.auth0.com",clientID:"3ys8tHNcg8hzzUeV-nizksE1lYw3bvBX",audience:require+"//web.archive.org/web/20241122211050/https://sso.testing-foxnews.com/userinfo",redirectUri:window.location.protocol+"//web.archive.org/web/20241122211050/https://global.fncstatic.com/static/orion/html/auth/Auth0/callback.html",responseType:"token id_token",responseMode:"fragment",scope:"openid email nickname"},silent:{usePostMessage:!0,postMessageDataType:"auth0"},popup:{}},options["lindahaviv.github.io"]={default:{domain:"testing-foxnews.auth0.com",clientID:"3ys8tHNcg8hzzUeV-nizksE1lYw3bvBX",audience:require+"//web.archive.org/web/20241122211050/https://sso.testing-foxnews.com/userinfo",redirectUri:require+"//web.archive.org/web/20241122211050/https://lindahaviv.github.io/auth0-good-poc/callback.html",responseType:"token id_token",responseMode:"fragment",scope:"openid email nickname"},silent:{usePostMessage:!0,postMessageDataType:"auth0"},popup:{}},options["aem-dev-publisher.foxnews.com"]={default:{domain:"my-dev.foxnews.com",clientID:"yFON2cS8aYLQVlMPqVnv87kmCyssN6Oq",audience:require+"//web.archive.org/web/20241122211050/https://sso.foxnews-dev.com/userinfo",overrides:{__tenant:"foxnews-dev",__token_issuer:require+"//web.archive.org/web/20241122211050/https://foxnews-dev.auth0.com/"},redirectUri:require+"//web.archive.org/web/20241122211050/https://dev.static.foxnews.com/community/auth/user/callback.html",responseType:"token",responseMode:"fragment",scope:"openid email nickname"},silent:{usePostMessage:!0,postMessageDataType:"auth0"},popup:{}},options["aem-dev-publisher.foxbusiness.com"]={default:{domain:"my-dev.foxnews.com",clientID:"yFON2cS8aYLQVlMPqVnv87kmCyssN6Oq",audience:require+"//web.archive.org/web/20241122211050/https://sso.foxnews-dev.com/userinfo",overrides:{__tenant:"foxnews-dev",__token_issuer:require+"//web.archive.org/web/20241122211050/https://foxnews-dev.auth0.com/"},redirectUri:require+"//web.archive.org/web/20241122211050/https://dev.static.foxnews.com/community/auth/user/callback.html",responseType:"token",responseMode:"fragment",scope:"openid email nickname"},silent:{usePostMessage:!0,postMessageDataType:"auth0"},popup:{}},options["beta.video.foxnews.com"]={default:{domain:"my-dev.foxnews.com",clientID:"yFON2cS8aYLQVlMPqVnv87kmCyssN6Oq",audience:require+"//web.archive.org/web/20241122211050/https://sso.foxnews-dev.com/userinfo",overrides:{__tenant:"foxnews-dev",__token_issuer:require+"//web.archive.org/web/20241122211050/https://foxnews-dev.auth0.com/"},redirectUri:require+"//web.archive.org/web/20241122211050/https://dev.static.foxnews.com/community/auth/user/callback.html",responseType:"token",responseMode:"fragment",scope:"openid email nickname"},silent:{usePostMessage:!0,postMessageDataType:"auth0"},popup:{}},options["beta-drupal7.nation.foxnews.com"]={default:{domain:"my-dev.foxnews.com",clientID:"yFON2cS8aYLQVlMPqVnv87kmCyssN6Oq",audience:require+"//web.archive.org/web/20241122211050/https://sso.foxnews-dev.com/userinfo",overrides:{__tenant:"foxnews-dev",__token_issuer:require+"//web.archive.org/web/20241122211050/https://foxnews-dev.auth0.com/"},redirectUri:require+"//web.archive.org/web/20241122211050/https://dev.static.foxnews.com/community/auth/user/callback.html",responseType:"token",responseMode:"fragment",scope:"openid email nickname"},silent:{usePostMessage:!0,postMessageDataType:"auth0"},popup:{}},options["foxnews.com"]={default:{domain:"my.foxnews.com",clientID:"DYfIjK4qF5e0soKD3cHasTsnp7KqYj0v",audience:require+"//web.archive.org/web/20241122211050/https://sso.foxnews.com/userinfo",overrides:{__tenant:"foxnews",__token_issuer:require+"//web.archive.org/web/20241122211050/https://foxnews.auth0.com/"},redirectUri:require+"//web.archive.org/web/20241122211050/https://www.foxnews.com/community/auth/user/callback.html",responseType:"token",responseMode:"fragment",scope:"openid email nickname"},silent:{usePostMessage:!0,postMessageDataType:"auth0"},popup:{}},options["video.foxnews.com"]={default:{domain:"my.foxnews.com",clientID:"DYfIjK4qF5e0soKD3cHasTsnp7KqYj0v",audience:require+"//web.archive.org/web/20241122211050/https://sso.foxnews.com/userinfo",overrides:{__tenant:"foxnews",__token_issuer:require+"//web.archive.org/web/20241122211050/https://foxnews.auth0.com/"},redirectUri:require+"//web.archive.org/web/20241122211050/https://www.foxnews.com/community/auth/user/callback.html",responseType:"token",responseMode:"fragment",scope:"openid email nickname"},silent:{usePostMessage:!0,postMessageDataType:"auth0"},popup:{}},options["nation.foxnews.com"]={default:{domain:"my.foxnews.com",clientID:"DYfIjK4qF5e0soKD3cHasTsnp7KqYj0v",audience:require+"//web.archive.org/web/20241122211050/https://sso.foxnews.com/userinfo",overrides:{__tenant:"foxnews",__token_issuer:require+"//web.archive.org/web/20241122211050/https://foxnews.auth0.com/"},redirectUri:require+"//web.archive.org/web/20241122211050/https://www.foxnews.com/community/auth/user/callback.html",responseType:"token",responseMode:"fragment",scope:"openid email nickname"},silent:{usePostMessage:!0,postMessageDataType:"auth0"},popup:{}},options});
Modulr.define("core.auth:pages/callback",["require","jquery","config"],function(require,$,config){if(window.parent!==window.self){var origin;try{origin=window.parent&&window.parent.location.href||window.location.origin,console.log("origin try"+origin)}catch(e){origin=window.location.origin,console.log("origin catch"+origin)}parent.postMessage({type:"auth0",hash:window.location.hash},"*")}else require(["models/fnnauth","models/callback"],function(Authentication,Callback){Callback(new Authentication(config.hostname)),Authentication.handleCallback()})});
Modulr.define("core.auth:pages/iframe",["require","jquery","lodash","config","models/fnnauth"],function(require,$,_,config){window.parent!==window.self&&window.location.search&&require(["models/fnnauth"],function(Authentication){var Auth,sendMessage=function(name,data){parent.postMessage({name:name,data:data,type:"fnnBrokerResponse"},qs.origin)},qs=function(){for(var vars={},params=window.location.search.substr(1).split("&"),i=0;i<params.length;i++){var keyValue=params[i].split("=");vars[keyValue[0]]=decodeURIComponent(keyValue[1])}return vars}();qs.domain&&qs.origin&&"undefined"!==qs.domain&&(Auth=new Authentication(qs.domain),window.addEventListener("message",function(event){event.origin===qs.origin&&event.data&&"fnnBrokerRequest"===event.data.type&&("silentLogin"===event.data.name?Auth.MODE_silentLogin(function(auth){Auth.getUserProfile(function(err,userProfile){auth.userInfo=userProfile,sendMessage(event.data.name,auth)})}):"startLogin"===event.data.name?Auth.startIframeLogin(event.data.data,function(url){sendMessage(event.data.name,url)}):"startLogout"===event.data.name&&Auth.startIframeLogout(function(err){sendMessage(event.data.name,err)}))}),sendMessage("ready"))})});
Modulr.define("core.auth:pages/profile",["require","jquery","config","helper","models/fnnauth"],function(require,$,config,Helper){require=new(require("models/fnnauth"))(config.hostname);Helper.log("core auth loaded",require),require.initialize("profile","login-container")});
!function(Modulr,FNC){var config,Instance,brokerListeners;function App(){}function broker(message,data,callback){["getFavorites","setFavorites","deleteFavorites","isLoggedIn","startPasswordless"].includes(message)&&Instance.require(["api"],function(API){API.middleware(function(Middleware){brokerListeners.includes("xd-channel-"+message)||(window.jQuery(document).on("xd-channel-"+message,function(e,favorites){callback(favorites)}),brokerListeners.push("xd-channel-"+message)),Middleware.broker.sendMessage(message,data)})})}Modulr.getInstance("core.auth")||(config={instance:"core.auth",baseDomain:FNC.CDN.domain,baseUrl:"/static/orion/scripts/core/auth/app",masterFile:"/static/orion/scripts/core/utils/modulr/master.js",paths:{},packages:["core.plugins"],shim:{jquery:{src:"/static/orion/scripts/core/utils/jquery/core.js",exports:"jQuery"},lodash:{src:"/static/orion/scripts/core/utils/lodash.js",exports:"_"},"akamai.geo":{src:"https://web.archive.org/web/20241122211050/https://static.foxnews.com/static/orion/scripts/core/utils/geo.js",exports:"FNC.GEO"},ISA:{src:"//web.archive.org/web/20241122211050/https://static.foxnews.com/static/isa/core.js",exports:"FNC.ISA"}}},(Instance=Modulr.config(config)).define("cdn",function(){return FNC.CDN}),Instance.define("fnc.isa",["ISA"],function(){return FNC.ISA}),window.FNC.core=window.FNC.core||{},window.FNC.core.auth=window.FNC.core.auth||(App.prototype.init=function(callback){(window.jQuery('meta[name="auth_type"]').attr("content")||null)&&Instance.require(["index"],function(App){"function"==typeof callback&&callback(App)})},App.prototype.set=function(callback){window.jQuery('meta[name="auth_type"]').attr("content")||null||Instance.require(["api"],function(API){"function"==typeof callback&&callback(API)})},App.prototype.isAuthenticated=function(callback){Instance.require(["api"],function(API){"function"==typeof callback&&callback(API.isAuthenticated())})},brokerListeners=[],App.prototype.FoxID={startPasswordless:function(options,callback){Instance.require(["api"],API=>{API.middleware(Middleware=>{Middleware.broker.startPasswordless(callback,options)})})},getFavorites:function(callback){broker("getFavorites","",callback)},setFavorites:function(favorites,callback){broker("setFavorites",favorites,callback)},deleteFavorites:function(favorites,callback){broker("deleteFavorites",favorites,callback)},isLoggedIn:function(callback){broker("isLoggedIn","",callback)},redirectToLogin:function(){Instance.require(["api"],function(API){API.middleware(function(Middleware){window.location=Middleware.broker.redirectURL})})}},new App))}(window.Modulr,(window.FNC=window.FNC||{},window.FNC.CDN=window.FNC.CDN||function(){for(var type="prod",mode="new",found=null,scripts=document.getElementsByTagName("script"),regexNew=/^(http(s|)\:|)\/\/((dev-|stage-|)static\.fox(news|business)\.com)\//,regexOld=/^(http(s|)\:|)\/\/((qa\.|)\global\.fncstatic\.com)\//,regexOldStage=/^(http(s|)\:|)\/\/(v8-staging\.fox(news|business)\.com)\//,i=0;i<scripts.length;i++){var src=scripts[i].getAttribute("src")||"";if(found)break;src&&(regexNew.test(src)?found=src:regexOld.test(src)?(found=src,mode="fncstatic"):regexOldStage.test(src)&&(found=src,mode="v8-staging"))}var domain=function(){var res,host;if(found)switch(mode){case"fncstatic":res=found.match(regexOld)[3],type=checkTypeOld(res)||type;break;case"v8-staging":res=found.match(regexOldStage)[3],type="staging";break;default:res=found.match(regexNew)[3],type=checkTypeNew(res)||type}else host=window.location.hostname,regexNew.test(host)?type=checkTypeNew(res=host)||type:regexOld.test(host)?type=checkTypeOld(res=host)||type:regexOldStage.test(host)?(res=host,type="staging"):res="static.foxnews.com";return res;function checkTypeNew(val){var ret=null;return/^dev\-/.test(val)?ret="qa":/^stage\-/.test(val)&&(ret="staging"),ret}function checkTypeOld(val){var ret=null;return ret=/^qa\./.test(val)?"qa":ret}}(),env="relative"===type?"prod":type,domain="//"+domain;return{domain:window.FOX_ENV_STATIC_DOMAIN=domain,env:window.FOX_ENV_STATIC=env}}(),window.FNC));

}
/*
     FILE ARCHIVED ON 21:10:50 Nov 22, 2024 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 20:23:13 Dec 01, 2024.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  captures_list: 0.689
  exclusion.robots: 0.025
  exclusion.robots.policy: 0.01
  esindex: 0.012
  cdx.remote: 163.286
  LoadShardBlock: 102.347 (3)
  PetaboxLoader3.datanode: 224.798 (4)
  load_resource: 346.235
  PetaboxLoader3.resolve: 218.076
*/